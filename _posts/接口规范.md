# 接口规范

| Request                           | Response                         | ServerNo                    | Client Message                     |
| --------------------------------- | -------------------------------- | --------------------------- | ---------------------------------- |
| time(客户端请求时间的秒级时间戳)  | ServerTime(服务器的响应时间)     | SN001:服务器器内部错误      | 客户端显示对应提示<br/>信息 SN001: |
| version(请求的接口的版本号)       | ServerNo(服务器响应的状态码)     | SN002:时间异常              |                                    |
| guid(携带的用户全局id)            | ResultData(服务器响应的业务数据) | SN003:版本号异常            |                                    |
| param(真实业务参数)               |                                  | SN004:全局⽤用户id不能为空  |                                    |
| platform(客户端代表的平台)        |                                  | SN005:签名错误              |                                    |
| signature(校验请求的合法性的签名) |                                  | SN006:⽆无权限访问          |                                    |
|                                   |                                  | SN007:服务器器维护状态      |                                    |
|                                   |                                  | SN008:当前⽤用户Token不存在 |                                    |
|                                   |                                  | SN009:当前用户Token已过期   |                                    |
|                                   |                                  | SN0010:当前用户Token错误    |                                    |
|                                   |                                  | SN0011:当前⽤户被封禁       |                                    |
|                                   |                                  | SN0012:当前设备被封禁       |                                    |

### 例子

请求参数例子

```json
{
    // 用户ID
    "guid":"3eaa1068934311e9b4a30242ac150005",
    
    // 版本号
    "version":'1.0',
    // 客户端平台
    "platform":1,
    // 请求的时间戳
    "time":1536587485,
    
    // 合法性签名
    "signature":"3eaa1068934311e9b4a30242ac150005",
    
    // 真实的请求参数
    "param":{"username":"admin","password":"123456"}
}
```





响应参数例子

```json
{
    // 响应时间
    "ServerTime":1536587485,
    // 响应状态码
    "ServerNo":"SN200",
    // 响应的数据结果
    "ResultData":{
        "info":"登录成功"
    }
}
```





# token查询

| Token                                      | 采取固定token的接口地址      |
| ------------------------------------------ | ---------------------------- |
| ******************************(32位字符串) | user/login<br/>user/register |

### hash规则表

```
[
  0=>[1,2,3,4,5,6],
  1=>[7,8,9,10,11,12],
  2=>[13,14,15,16,17,18],
  3=>[19,20,21,22,23,24],
  4=>[25,26,27,28,29,30],
  5=>[31,32,33,34,35,36],
  6=>[37,38,39,40,41,42],
  7=>[43,44,45,46,47,48]
]
```



### 校验签名的规则

校验签名是为了保证请求是由我们客户端的用户发出的合法请求

> 防止xss攻击或者csrf攻击

#### 签名生成的规则

```
md5(path+time+guid+platform+param+cryptToken)
```

####  其中 cryptToken 使⽤用token经过以下过程加密创建

1. Token 一定是32位的16进制数 如 0cc175b9c0f1b6a831c399e269772661
2. 取Token 的第2位,5位,8位(从第0开始) 如 c5c(具体取哪3位可自定义,只要前后台约定好即可)
3. 把16进制转10进制数字 如 c5c ->3164
4. 对10进制数 除以 8 求余数 如 3164 % 8 = 4
5. 查找hash 表格4 对应的规则
6. 取的上述4对应的规则数组 4 : [25,26,27,28,29,30]
7. 循环数组[29,2,11,17,21,26] 对应的数字去取Token 中对应的位置字符 6c1197
8. 最后用户登录后的 cryptToken = 6c1197

> 注意，部分未登录接口使用固定的guid以及cryptToken(例如afisde),需要提前约定好

